<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tes</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/super-hands@3.0.0/dist/super-hands.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>
</head>

<body>
    <a-scene physics="debug: false">
        <a-assets>
            <a-asset-item id="fan" src="./assets/fan/scene.gltf"></a-asset-item>
            <a-asset-item id="hdd" src="./assets/hdd/scene.gltf"></a-asset-item>
            <a-asset-item id="ram" src="./assets/ram/scene.gltf"></a-asset-item>
            <a-asset-item id="ssd" src="./assets/ssd/scene.gltf"></a-asset-item>
            <a-asset-item id="cpu" src="./assets/cpu/scene.gltf"></a-asset-item>
            <a-asset-item id="gpu" src="./assets/gpulow/scene.gltf"></a-asset-item>
            <a-asset-item id="psu" src="./assets/psu/scene.gltf"></a-asset-item>
            <a-asset-item id="mobo" src="./assets/mobo/scene.gltf"></a-asset-item>
            <a-asset-item id="table" src="./assets/table/scene.gltf"></a-asset-item>
            <a-asset-item id="shop-obj" src="./assets/SHOP/ShopLow.obj"></a-asset-item>
            <a-asset-item id="shop-mtl" src="./assets/SHOP/ShopLow.mtl"></a-asset-item>
            <a-mixin id="controller" physics-collider static-body="shape: sphere; sphereRadius: 0.02" super-hands="colliderEvent: collisions;
                             colliderEventProperty: els;
                             colliderEndEvent: collisions;
                             colliderEndEventProperty: clearedEls" collision-filter="group: hands;
                                    collidesWith: blue;
                                    collisionForces: false">
            </a-mixin>
            <a-mixin id="object" dynamic-body grabbable></a-mixin>
            <a-mixin id="kotak" static-body collision-filter="collidesWith: blue, default, red, hands"></a-mixin>
        </a-assets>
        <a-entity hand-controls="hand: left" model: true mixin="controller">
        </a-entity>
        <a-entity hand-controls="hand: right" model: true mixin="controller">
        </a-entity>
        <!-- Menambahkan movement-controls untuk karakter pemain -->
        <a-entity id="player" movement-controls
            collision-filter="group: player; collidesWith: blue, default, red, hands">
            <a-camera position="0 1 1" rotation="0 0 0"></a-camera>
        </a-entity>

        <a-box static-body collision-filter="collidesWith: blue, default, red, hands" position="1 0.5 -0.5" material="color: gray"
                width="5" height="0.5" depth="1">
        </a-box>
        <a-box static-body collision-filter="collidesWith: blue, default, red, hands" position="-3 0.5 0" rotation="0 90 0" material="color: gray"
                width="5" height="0.5" depth="1">
        </a-box>
        <a-entity obj-model="obj: #shop-obj; mtl: #shop-mtl" scale="2 2 2" position="-1 3.5 2"
            rotation="0 0 0" ></a-entity>
        <a-camera position="0 1 1" rotation="0 0 250"></a-camera>

        <!-- item komputer -->
        <a-entity mixin="object" gltf-model="#fan" scale="0.4 0.4 0.4" position="-0.3 0.7 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="-0.3 0.7 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#hdd" scale="0.3 0.3 0.3" position="0 0.7 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="0 0.7 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#ram" scale="0.05 0.05 0.05" position="0.3 0.7 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="0.3 0.7 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#ssd" scale="1 1 1" position="0.6 0.7 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="0.6 0.7 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#cpu" scale="0.05 0.05 0.05" position="0.9 1 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="0.9 1 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#gpu" scale="0.05 0.05 0.05" position="1.35 0.9 -0.2"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="1.35 0.9 -0.2" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#psu" scale="0.005 0.005 0.005" position="-1.2 1 -0.3"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="-1.2 1 -0.3" sleepy></a-entity>
        <a-entity mixin="object" gltf-model="#mobo" scale="0.1 0.1 0.1" position="-0.6 1 -0.2"
            collision-filter="group: blue; collidesWith:default, blue, hands" respawn original-position="-0.6 1 -0.2" sleepy></a-entity>
        <!-- text aja -->
        <a-text value="<Fan>" position="-3 1 2.2" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<HDD>" position="-3 1 1.8" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<RAM>" position="-3 1 1.4" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<SSD>" position="-3 1 1" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<CPU>" position="-3 1 0.6" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<GPU>" position="-3 1 0.2" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<PSU>" position="-3 1 -0.2" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <a-text value="<Motherboard>" position="-3 1 -0.6" rotation="0 90 0" scale="0.5 0.5 0.5" color="black"></a-text>
        <!-- dataran tembok -->
        <a-plane material="color: gray;" width="15" height="15" rotation="-90 0 0" position="0 0 0" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>
        <a-plane material="color: gray;" width="15" height="15" rotation="-90 0 0" position="0 9 0" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>
        <a-plane material="color: gray;" width="15" height="15" rotation="0 0 0" position="0 0 -7" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>
        <a-plane material="color: gray;" width="15" height="15" rotation="0 90 0" position="-7 0 0" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>
        <a-plane material="color: gray;" width="15" height="15" rotation="0 -90 0" position="7 0 0" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>
        <a-plane material="color: gray;" width="15" height="15" rotation="0 180 0" position="0 0 7" static-body
            collision-filter="collidesWith: blue" physics-collider></a-plane>

    </a-scene>

    <script>
        AFRAME.registerComponent('grabbable', {
            init: function () {
                var el = this.el;

                el.addEventListener('grab-start', function (event) {
                    var grabbedEntity = event.detail.target;
                    grabbedEntity.setAttribute('dynamic-body', 'mass: 0');
                });

                el.addEventListener('grab-end', function (event) {
                    var grabbedEntity = event.detail.target;
                    grabbedEntity.removeAttribute('dynamic-body');
                });
            }
        });

        document.getElementById('toggleVRButton').addEventListener('grab-start', function () {
            var playerCamera = document.getElementById('player');
            var isVRMode = playerCamera.getAttribute('look-controls') ? true : false;

            if (isVRMode) {
                playerCamera.removeAttribute('look-controls');
                console.log('VR Mode Disabled');
            } else {
                playerCamera.setAttribute('look-controls', '');
                console.log('VR Mode Enabled');
            }
        });
        AFRAME.registerComponent('respawn', {
            init: function () {
                var el = this.el;

                // Memeriksa tabrakan dengan tanah
                el.addEventListener('collide', function (event) {
                    var collidedWith = event.detail.body.el;

                    // Jika objek menabrak tanah, respawn ke posisi awal
                    if (collidedWith.tagName.toLowerCase() === 'a-plane') {
                        el.setAttribute('position', el.getAttribute('original-position'));
                    }
                });
            }
        });
    </script>
</body>

</html>